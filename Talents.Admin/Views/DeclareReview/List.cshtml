
@{
	var pageTitle = ViewBag.Title = "教师申报审核列表";
	//var teacherId = Request["teacherId"];
	//var schoold= HttpAntiForgeryException.
}
<div class="col-md-10 content-wrapper">
	<div class="row">
		<div class="col-lg-4 ">
			<ul class="breadcrumb">
				<li class="active"><i class="fa fa-home"></i><a href="@Url.Action("Index", "Home")">首页</a></li>
				<li class="active">@pageTitle</li>
			</ul>
		</div>
	</div>

	<!-- main -->
	<div class="content">
		<div class="main-header">
			<h2><i class="fa fa-users"></i> @pageTitle</h2>
		</div>

		<div class="main-content">

			<!-- /top action buttons -->
			<!-- widget -->
			<div class="widget">
				<div class="widget-header">
					<h3><i class="fa fa-paperclip"></i> 申报教师列表</h3>
					<div class="btn-group widget-header-toolbar">
						<a href="javascript:;" title="焦点" class="btn-borderless btn-focus"><i class="fa fa-eye"></i></a>
						<a href="javascript:;" title="全屏" class="btn-borderless btn-expand"><i class="fa fa-expand"></i></a>
					</div>
				</div>
				<div class="widget-content">

					<!-- Grid -->
					<div class="table-responsive">
						<table id="bootgrid" class="table table-striped table-hover table-dark-header">
							<thead>
								<tr>
									<th data-column-id="id" data-order="desc">申报编号</th>
									<th data-column-id="realName" data-order="desc">申报教师</th>
									<th data-column-id="company" data-order="desc">申报单位</th>
									<th data-column-id="declare" data-order="desc">申报称号</th>
									<th data-column-id="subject" data-order="desc">申报学科</th>
									<th data-column-id="status" data-order="desc">审核状态</th>
									<th data-column-id="commands" data-formatter="commands" data-sortable="false" data-header-Css-Class="width180">操作</th>
								</tr>
							</thead>
						</table>
					</div>
					<!-- end Grid-->

				</div>
				<!-- /widget content -->
			</div>
			<!-- /widget -->

		</div>
		<!-- /main-content -->
	</div>
	<!-- /main -->
</div>
@section Modals {
	<button class="btn btn-md btn-custom-primary hidden" id="modelProxy" data-toggle="ajax-modal" data-target="#firstModal">代理</button>
	<!-- Modal start -->
	<div class="modal" id="firstModal" tabindex="-1" role="dialog" aria-labelledby="firstModalLabel" aria-hidden="true">
	</div>
	<!-- Modal end -->
}
@section Scripts {
	<script>

		function getGlobalRequest() {
			return {

			};
		}

		function getGridOptions() {
			return $.extend(true, {}, gridOptions, {

				url: window.location.href,

				requestHandler: function (request) { return $.extend(true, request, getGlobalRequest()); },

				formatters: {
					'commands': function (column, row) {
						var typeKey = row.typeKey;
						var targetId = '@DeclareTargetIds.XuekDaitr';
						var previewUrl = '/DeclareMaterial/Preview?teacherId=' + row.teacherId + '&typeKey=' + typeKey + '&view=MaterialPreview5005&declareTargetId=' + targetId;
						var downloadUrl = '/DeclareMaterial/Preview?teacherId=' + row.teacherId + '&typeKey=' + typeKey + '&view=MaterialPreview5005&declareTargetId=' + targetId + '&isExport=true';
						var temp = '<a target="_blank" href="' + previewUrl + '" class="btn btn-warning btn-overview"><i class="fa fa-external-link"></i>查看材料</a>' +
							        '<a target="_blank" href="' + downloadUrl + '" class="btn btn-info btn-downlaod"><i class="fa fa-external-link"></i>下载材料</a>';
						return '<div class="btn-group btn-group-xs pull-right"  data-row-id="' + row.id + '">' +
								 temp +
								 '<a class="btn btn-danger btn-review" data-toggle="ajax-modal" data-target="#firstModal" title="申报审核">申报审核</a>' +
								 '</div>';
					},
				},

			});
		}

		$(function () {

			var grid = $('#bootgrid');
			grid.bootgrid(getGridOptions())
			.on('loaded.rs.jquery.bootgrid', function () {

				grid.find('.btn-review').on('click', function (e) {
					var id = $(this).parent().data('rowId');
					var $proxy = $('#modelProxy');
					var url = '/DeclareReview/Edit/?id=' + id;
					$proxy
						.data('url', url)
						.trigger('click');
				});
			});

		});

	</script>
}